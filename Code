data<-read.csv("NY Economic Incentives.csv")
str(data)

#regression analysis
library(car)

#recode categorical variables to dummy variables
dummy_variables <- Total.State.Awards ~ Disbursements.to.Date + factor(Region) + factor(Industry) +factor(Program.Type)


regression <- lm(dummy_variables, data = data)
summary(regression)

cor(data$Total.State.Awards, data$Disbursements.to.Date)
#checking OLS Assumptions 
#Right Variables: assume that we use the right variables

#Linear in the parameters: yes

#Homoscedasticity - no violation, scale - location plot partial violation

#Influential outliers - no influential outliers based on the Residuals vs. Leverage plot 

#Normally distribution errors: no violation Q-Q Residuals line is flat

#Independent errors: Residuals vs. Leverage no violation, data is withing Cook's distance lines

#check for multicollinearity - no violation vif is less than 4

vif(regression)
install.packages("stargazer")
library(stargazer)
regression$coefficients <- regression$coefficients / 1000000 #divide by 1000000 to avoid large numbers 
regression$residuals <- regression$residuals / 1000000
regression$fitted.values <- regression$fitted.values / 1000000
stargazer(regression, type = "text")

#check for violation of assumptions plots
plot(regression)


#quantitative analysis
library(summarytools)
library(dplyr)
data |> select(Total.State.Awards, Disbursements.to.Date) |>
  descr()

#qualitative analysis
freq(data$Program)
freq(data$Industry)
freq(data$Region)

#F^2 test 
0.02036/(1-0.02036) # F^2 = 0.207 Region, Program, Industry, and Disbursement Awards have a moderate effect on Total State Awards.

#power analysis
library(pwr)
pwr.f2.test(v=44439, u=20, f2 = 0.0207, sig.level = 0.1, power = NULL) 

